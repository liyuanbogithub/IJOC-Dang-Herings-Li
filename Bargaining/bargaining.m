%Example in Herings's paper
clear;
global s n m u tpm pm0

s = 6;
n = 2;
m = zeros(6, 2);

m(1, 1) = 2;
m(1, 2) = 2;
m(2, 1) = 2;
m(2, 2) = 2;
m(3, 1) = 2;
m(3, 2) = 2;
m(4, 1) = 1;
m(4, 2) = 1;
m(5, 1) = 1;
m(5, 2) = 1;
m(6, 1) = 1;
m(6, 2) = 1;

pm0 = zeros(s, 1);
for q = 1:s
    pm0(q) = prod(m(q, :));
end

u = zeros(2, 4, 6);
u(:, 1:pm0(1), 1) = [1 1 1 0; -1 -1 -1 0];
u(:, 1:pm0(2), 2) = [0 0 0 0; -1 -1 -1 0];
u(:, 1:pm0(3), 3) = [-1 -1 -1 0; 0 0 0 0];
u(:, 1:pm0(4), 4) = [1; -1];
u(:, 1:pm0(5), 5) = [0; 1];
u(:, 1:pm0(6), 6) = [-1; 0];

tpm = zeros(2, 4, 2, 2);
tpm(:, 1:pm0(1), 1, 1) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(1), 1, 2) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(1), 1, 3) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(1), 1, 4) = [1 1 1 0; 1 1 1 0];
tpm(:, 1:pm0(1), 1, 5) = [0 0 0 0; 0 0 0 0];
tpm(:, 1:pm0(1), 1, 6) = [0 0 0 0; 0 0 0 0];

tpm(:, 1:pm0(2), 2, 1) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(2), 2, 2) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(2), 2, 3) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(2), 2, 4) = [0 0 0 0; 0 0 0 0];
tpm(:, 1:pm0(2), 2, 5) = [1 1 1 0; 1 1 1 0];
tpm(:, 1:pm0(2), 2, 6) = [0 0 0 0; 0 0 0 0];

tpm(:, 1:pm0(3), 3, 1) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(3), 3, 2) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(3), 3, 3) = [0 0 0 1/3; 0 0 0 1/3];
tpm(:, 1:pm0(3), 3, 4) = [0 0 0 0; 0 0 0 0];
tpm(:, 1:pm0(3), 3, 5) = [0 0 0 0; 0 0 0 0];
tpm(:, 1:pm0(3), 3, 6) = [1 1 1 0; 1 1 1 0];

tpm(:, 1:pm0(4), 4, 1) = [0; 0];
tpm(:, 1:pm0(4), 4, 2) = [0; 0];
tpm(:, 1:pm0(4), 4, 3) = [0; 0];
tpm(:, 1:pm0(4), 4, 4) = [1; 1];
tpm(:, 1:pm0(4), 4, 5) = [0; 0];
tpm(:, 1:pm0(4), 4, 6) = [0; 0];

tpm(:, 1:pm0(5), 5, 1) = [0; 0];
tpm(:, 1:pm0(5), 5, 2) = [0; 0];
tpm(:, 1:pm0(5), 5, 3) = [0; 0];
tpm(:, 1:pm0(5), 5, 4) = [0; 0];
tpm(:, 1:pm0(5), 5, 5) = [1; 1];
tpm(:, 1:pm0(5), 5, 6) = [0; 0];

tpm(:, 1:pm0(6), 6, 1) = [0; 0];
tpm(:, 1:pm0(6), 6, 2) = [0; 0];
tpm(:, 1:pm0(6), 6, 3) = [0; 0];
tpm(:, 1:pm0(6), 6, 4) = [0; 0];
tpm(:, 1:pm0(6), 6, 5) = [0; 0];
tpm(:, 1:pm0(6), 6, 6) = [1; 1];

ycsgse;
%dltpsgse;
